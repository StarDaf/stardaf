{% for product in products %}


                      <div class="col-sm-3">
                      <div class="card">
                      {% comment %} {% if not product.video %}
                        <a href='{{ product.get_absolute_url }}'><img class="card-img-top" src="{{ product.photo.url }}" alt="{{ product.id }}" style='height:auto'></a>
                      {% else %}

                        <a href='{{ product.get_absolute_url }}'><video width="100%" height="100%" controls {% if product.photo %}poster="{{ product.photo.url }}"{% endif %}>
                            <source src="{{ product.video.url }}" type="video/mp4">
                            Your browser does not support the video tag.
                        </video></a>

                      {% endif %} {% endcomment %}
                      <a href='{{ product.get_absolute_url }}'>
                      <div id="carousel_{{ product.id }}" class="carousel slide" data-interval="false">
  <!--Indicators-->
  <ol class="carousel-indicators">
    {% if product.video %}<li data-target="#carousel_{{ product.id }}" data-slide-to="0" {% if product.video %}class='active'{% endif %}></li>{% endif %}
    <li data-target="#carousel_{{ product.id }}" data-slide-to="1" {% if not product.video %}class='active'{% endif %}></li>
    {% if product.photo1 %}<li data-target="#carousel_{{ product.id }}" data-slide-to="2"></li>{% endif %}
    {% if product.photo2 %}<li data-target="#carousel_{{ product.id }}" data-slide-to="3"></li>{% endif %}
    {% if product.photo3 %}<li data-target="#carousel_{{ product.id }}" data-slide-to="4"></li>{% endif %}
    
  </ol>
  <!--/.Indicators-->
  <!--Slides-->
  <div class="carousel-inner" role="listbox">
    <!--First slide-->
    {% if product.video  %}
        <div class="carousel-item active">
            
                <video width="100%" height="100%"  controls {% if product.photo %}poster="{{ product.photo.url }}"{% endif %}>
                        <source src="{{ product.video.url }}" type="video/mp4">
                        Update your browser.
                    </video>
            
        </div>
    {% endif %}
    <!--/First slide-->
    <!--Second slide-->
    {% if product.photo %}
    <div class="carousel-item {% if not product.video %}active{% endif %}">
        
            <img class="card-img-top" src="{{ product.photo.url }}" style='height:auto; width:100%;' alt="First slide">
           
    </div>
    {% endif %}
    <!--/Second slide-->
    <!--Third slide-->
    {% if product.photo1 %}
    <div class="carousel-item ">
        
            <img class="card-img-top" src="{{ product.photo1.url }}" style='height:auto; width:100%;' alt="First slide">
           
    </div>
    {% endif %}
    <!--/Third slide-->
    {% if product.photo2 %}
    <div class="carousel-item ">
        
            <img class="card-img-top" src="{{ product.photo2.url }}" style='height:auto; width:100%;' alt="First slide">
           
    </div>
    {% endif %}
    {% if product.photo3 %}
    <div class="carousel-item ">
        
            <img class="card-img-top" src="{{ product.photo3.url }}" style='height:auto; width:100%;' alt="First slide">
           
    </div>
    {% endif %}
  </div>
  <!--/.Slides-->
  <!--Controls-->
 {% if product.video or product.photo1 %}
  <a class="carousel-control-next" href="#carousel_{{ product.id }}" role="button" data-slide="next">
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
    <span class="sr-only">Next</span>
  </a>
  {% endif %}
  <!--/.Controls-->
</div></a>
<!--/.Carousel Wrapper-->

                        <div class="card-body">
                          <a href='#' data-id='{{ product.id }}'
                         data-action='{% if request.user in product.users_like.all %}un{% endif %}like' class='like'
                           id='{{ product.id }}'>
                        {% if request.user not in product.users_like.all %}
                            <i class="fa fa-heart-o "></i>
                            <!--Like-->
                        {% else %}
                            <i class="fa fa-heart "></i>
                            <!--Like-->
                        {% endif %}
                </a>&nbsp;
                <span><a href="{{ product.get_absolute_url }}"  style="text-decoration: none;">
                    <span class="text-muted"><i class="fa fa-eye"></i>
                            {{ product.total_views }}
                        </span>
                </a></span>&nbsp;
                <span class="float-right mx-2"><a href='{% if not request.user.is_authenticated %}{% url 'account:register' %}{% else %}{% url 'bizz:recommend' request.user.id product.id %}{% endif %}'><i class="fa fa-hand-spock-o pull-right icons"></i></a></span>
                <span class="float-right mx-2"><a href='{% url 'cart:home' product.pk %}'><i class="fa fa-plus-circle pull-right icons"></i></a></span>
                          <h5 class="card-title"><a href='{{ product.get_absolute_url }}'>{{ product.name }}</a></h5>
                          <p class="card-text">{{ product.description|truncatewords:15 }}<br/>
                          stock: {{ product.stock }}<br/>
                            {% if request.user.id == user.shop.owner.id %}
                              <form action="{% url 'bizz:stock' product.id %}" method='post'>
                                        {{ form.as_p }}
                                            {% csrf_token %}
                                            <!--<input type="submit" value="Update" class="btn btn-secondary btn-sm">-->
                                            <button type='submit' class="btn btn-secondary btn-sm mx-3">update</button>
                                </form>
                              <a href="{% url 'bizz:delete' product.id %}">Delete</a></p>
                            {% endif %}

                        </div>
                        <div class="card-footer">
                          <small class="text-muted">
                            {% with total_comments=product.comments.count %}
                              {{ total_comments }} comment{{ total_comments|pluralize }}
                            {% endwith %}
                          </small><br/>
                          <small class="text-muted">Uploaded {{ product.created|timesince }} ago</small><br/>
                          <!--<small class="text-muted">Updated {{ product.updated|timesince }} ago</small>-->
                        </div>
                      </div>
                      </div>
              <!--</div>-->

                {% empty %}
                {% if request.user.shop %}
                  
                {% else %}
                 
                {% endif %}    
                {% endfor %}